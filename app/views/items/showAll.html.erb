<script>
!function($){var e=$.fn.jquery.split("."),t=parseFloat(e[0]),i=parseFloat(e[1]);t<2&&i<8?($.expr[":"].filterTableFind=function(e,t,i){return $(e).text().toUpperCase().indexOf(i[3].toUpperCase().replace(/"""/g,'"').replace(/"\\"/g,"\\"))>=0},$.expr[":"].filterTableFindAny=function(e,t,i){var n=i[3].split(/[\s,]/),r=[];return $.each(n,function(e,t){var i=t.replace(/^\s+|\s$/g,"");i&&r.push(i)}),!!r.length&&function(e){var t=!1;return $.each(r,function(i,n){if($(e).text().toUpperCase().indexOf(n.toUpperCase().replace(/"""/g,'"').replace(/"\\"/g,"\\"))>=0)return t=!0,!1}),t}},$.expr[":"].filterTableFindAll=function(e,t,i){var n=i[3].split(/[\s,]/),r=[];return $.each(n,function(e,t){var i=t.replace(/^\s+|\s$/g,"");i&&r.push(i)}),!!r.length&&function(e){var t=0;return $.each(r,function(i,n){$(e).text().toUpperCase().indexOf(n.toUpperCase().replace(/"""/g,'"').replace(/"\\"/g,"\\"))>=0&&t++}),t===r.length}}):($.expr[":"].filterTableFind=jQuery.expr.createPseudo(function(e){return function(t){return $(t).text().toUpperCase().indexOf(e.toUpperCase().replace(/"""/g,'"').replace(/"\\"/g,"\\"))>=0}}),$.expr[":"].filterTableFindAny=jQuery.expr.createPseudo(function(e){var t=e.split(/[\s,]/),i=[];return $.each(t,function(e,t){var n=t.replace(/^\s+|\s$/g,"");n&&i.push(n)}),!!i.length&&function(e){var t=!1;return $.each(i,function(i,n){if($(e).text().toUpperCase().indexOf(n.toUpperCase().replace(/"""/g,'"').replace(/"\\"/g,"\\"))>=0)return t=!0,!1}),t}}),$.expr[":"].filterTableFindAll=jQuery.expr.createPseudo(function(e){var t=e.split(/[\s,]/),i=[];return $.each(t,function(e,t){var n=t.replace(/^\s+|\s$/g,"");n&&i.push(n)}),!!i.length&&function(e){var t=0;return $.each(i,function(i,n){$(e).text().toUpperCase().indexOf(n.toUpperCase().replace(/"""/g,'"').replace(/"\\"/g,"\\"))>=0&&t++}),t===i.length}})),$.fn.filterTable=function(e){var t={autofocus:!1,callback:null,containerClass:"filter-table",containerTag:"p",filterExpression:"filterTableFind",hideTFootOnFilter:!1,highlightClass:"alt",ignoreClass:"",ignoreColumns:[],inputSelector:null,inputName:"",inputType:"search",label:"<b>Filter:</b>",minChars:1,minRows:8,placeholder:"",preventReturnKey:!0,quickList:[],quickListClass:"quick",quickListClear:"",quickListGroupTag:"",quickListTag:"a",visibleClass:"visible"},i=function(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},n=$.extend({},t,e),r=function(e,t){var i=e.find("tbody");if(""===t||t.length<n.minChars)i.find("tr").show().addClass(n.visibleClass),i.find("td").removeClass(n.highlightClass),n.hideTFootOnFilter&&e.find("tfoot").show();else{var r=i.find("td");if(i.find("tr").hide().removeClass(n.visibleClass),r.removeClass(n.highlightClass),n.hideTFootOnFilter&&e.find("tfoot").hide(),n.ignoreColumns.length){var a=[];n.ignoreClass&&(r=r.not("."+n.ignoreClass)),a=r.filter(":"+n.filterExpression+'("'+t+'")'),a.each(function(){var e=$(this),t=e.parent().children().index(e);$.inArray(t,n.ignoreColumns)===-1&&e.addClass(n.highlightClass).closest("tr").show().addClass(n.visibleClass)})}else n.ignoreClass&&(r=r.not("."+n.ignoreClass)),r.filter(":"+n.filterExpression+'("'+t+'")').addClass(n.highlightClass).closest("tr").show().addClass(n.visibleClass)}n.callback&&n.callback(t,e)};return this.each(function(){var e=$(this),t=e.find("tbody"),a=null,l=null,s=null,c=!0;if("TABLE"===e[0].nodeName&&t.length>0&&(0===n.minRows||n.minRows>0&&t.find("tr").length>=n.minRows)&&!e.prev().hasClass(n.containerClass)){if(n.inputSelector&&1===$(n.inputSelector).length?(s=$(n.inputSelector),a=s.parent(),c=!1):(a=$("<"+n.containerTag+" />"),""!==n.containerClass&&a.addClass(n.containerClass),a.prepend(n.label+" "),s=$('<input type="'+n.inputType+'" placeholder="'+n.placeholder+'" name="'+n.inputName+'" />'),n.preventReturnKey&&s.on("keydown",function(e){if(13===(e.keyCode||e.which))return e.preventDefault(),!1})),n.autofocus&&s.attr("autofocus",!0),$.fn.bindWithDelay?s.bindWithDelay("keyup",function(){r(e,$(this).val())},200):s.bind("keyup",function(){r(e,$(this).val())}),s.bind("click search input paste blur",function(){r(e,$(this).val())}),c&&a.append(s),n.quickList.length>0||n.quickListClear){if(l=n.quickListGroupTag?$("<"+n.quickListGroupTag+" />"):a,$.each(n.quickList,function(e,t){var r=$("<"+n.quickListTag+' class="'+n.quickListClass+'" />');r.text(i(t)),"A"===r[0].nodeName&&r.attr("href","#"),r.bind("click",function(e){e.preventDefault(),s.val(t).focus().trigger("click")}),l.append(r)}),n.quickListClear){var o=$("<"+n.quickListTag+' class="'+n.quickListClass+'" />');o.html(n.quickListClear),"A"===o[0].nodeName&&o.attr("href","#"),o.bind("click",function(e){e.preventDefault(),s.val("").focus().trigger("click")}),l.append(o)}l!==a&&a.append(l)}c&&e.before(a)}})}}(jQuery);

$(".xxx").click(function() {
    if (0) return;
    else{
    var body, id;
    $.ajax({
    type: 'GET',
    dataType: 'json',
    url: "show",
    async: false,
    success: function(data){
        $.each(data, function (key, text) {
            $.each(text, function (index, value) {
                if (index === "id") {if (max < value) max = value;}
                if (index === "body") {body = value;}
                if (index === "created_at") {
                    created_at2 = value;
                    created_at = created_at2.slice(0, 10) + " " + created_at2.slice(11, 19);
                }
                if (index === "name") {$( ".comments").append("<div />", {'id': id}).append( "<br/><table><tr><th><b>&nbsp;&nbsp;" + value + " " + "<span>" + created_at + "</span></b></th></tr><tr><td>" + "<p>" + body + "</p></td></tr></table>" );}});});}});
};})
</script>
<style>
h3 {font-size: 120%; text-align: center;}
</style>
<div class="container">
    <div class="row">
        <div class="col-4 group-image-none">
            <br/>
            <%= image_tag @group.image, style:"width: 100%; height: 100%; object-fit: cover;" %>
        </div>
        <div class="col">
            <br/>
            <h2 style="color: blue; text-align: center" class="item-showall-text"><%= @group.title %></h2>
            <span class="markdown-justify"><%= markdown(@group.description) %></span>
            <span class="markdown-justify">Автор: <%= link_to User.find(@group.user_id).name, user_root_path(:id => User.find(@group.user_id).id) %></span>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <br>
            <hr>
            <center>
                <main class="table-hover">
                <table id="table" class="sortable">
                    <thead>
                      <tr>
                         <th><h3 class="item-showall-text" >Title&nbsp;</h3></th>
                         <th><h3 class="item-showall-text">Created at&nbsp;</h3></th>
                         <th><h3 class="item-showall-text">Updated at&nbsp;</h3></th>
                         <% if @item1 %>
                            <% @item_apps.where(item_id: @item1.id).each do |item_app| %>
                                <th id="table-none"><h3><%= @group_apps.find(item_app.group_app_id).title %>&nbsp;</h3></th>
                            <% end %>
                         <% end %>
                         <% if user_signed_in? %>
                             <% if (current_user.id == @group.user_id) || (current_user.admin) %>
                                <th class="nosort"></th>
                             <% end %>
                         <% end %>
                      </tr>
                    </thead>
                    <tbody>
                      <% @group.items.each do |item| %>
                        <tr id="tr" style="cursor: pointer" onclick="window.location.href='https://mydearfriend.herokuapp.com/items/showOne?group_id=<%= @group.id %>&id=<%= item.id %>';">
                        <td ><%= item.title%></td>
                        <td class="xxx"><%= item.created_at.strftime("%Y-%m-%d %R") %></td>
                        <td><%= item.updated_at.strftime("%Y-%m-%d %R") %></td>
                        <% if @item1 %>
                            <% @item_apps.where(item_id: item.id).each do |item_app| %>
                                <% if item_app.string %>
                                    <td id="table-none"><%= item_app.string %></td>
                                <% end %>
                                <% if item_app.text %>
                                    <td id="table-none"><%= markdown(item_app.text) %></td>
                                <% end %>
                                <% if  @group_apps.find(item_app.group_app_id).type_data == "Boolean" %>
                                    <% if item_app.boolean %>
                                        <td id="table-none"><input type="checkbox" checked disabled = 1"></td>
                                    <% else %>
                                        <td id="table-none"><input type="checkbox" disabled = 1"></td>
                                    <% end %>
                                <% end %>
                                <% if item_app.date %>
                                   <td id="table-none"> <%= item_app.date %></td>
                                <% end %>
                                <% if item_app.float %>
                                    <td id="table-none"><%= item_app.float %></td>
                                <% end %>
                            <% end %>
                        <% end %>
                        <% if user_signed_in? %>
                            <% if (current_user.id == @group.user_id) || (current_user.admin) %>
                                <td onclick="event.stopPropagation ? event.stopPropagation() : (event.cancelBubble=true)">
                                    <%= link_to image_tag("/assets/edit.png", height: "20px"), edit_group_item_path(@group.id, item) %>

                                </td>
                            <% end %>
                        <% end %>
                      </tr>
                      <% end %>
                    </tbody>
                </table>
                </main>
                <% if user_signed_in? %>
                <% if (current_user.id == @group.user_id) || (current_user.admin) %>
                    <div>
                        <%= link_to image_tag("/assets/plus.png", height: "20px"), new_group_item_path(@group.id) %>
                    </div>
                <% end %>
                <% end %>
            </center>
            <script>
                $(document).ready(function () {$('table').filterTable({minRows: 0}); });
            </script>
        </div>
    </div>
</div>
<br/>
<script type="text/javascript">
var TINY={};function T$(i){return document.getElementById(i)}function T$$(e,p){return p.getElementsByTagName(e)}TINY.table=function(){function sorter(n){this.n=n;this.pagesize=20;this.paginate=0}sorter.prototype.init=function(e,f){var t=ge(e),i=0;this.e=e;this.l=t.r.length;t.a=[];t.h=T$$('thead',T$(e))[0].rows[0];t.w=t.h.cells.length;for(i;i<t.w;i++){var c=t.h.cells[i];if(c.className!='nosort'){c.className=this.head;c.onclick=new Function(this.n+'.wk(this.cellIndex)')}}for(i=0;i<this.l;i++){t.a[i]={}}if(f!=null){var a=new Function(this.n+'.wk('+f+')');a()}if(this.paginate){this.g=1;this.pages()}};sorter.prototype.wk=function(y){var t=ge(this.e),x=t.h.cells[y],i=0;for(i;i<this.l;i++){t.a[i].o=i;var v=t.r[i].cells[y];t.r[i].style.display='';while(v.hasChildNodes()){v=v.firstChild}t.a[i].v=v.nodeValue?v.nodeValue:''}for(i=0;i<t.w;i++){var c=t.h.cells[i];if(c.className!='nosort'){c.className=this.head}}if(t.p==y){t.a.reverse();x.className=t.d?this.asc:this.desc;t.d=t.d?0:1}else{t.p=y;t.a.sort(cp);t.d=0;x.className=this.asc}var n=document.createElement('tbody');for(i=0;i<this.l;i++){var r=t.r[t.a[i].o].cloneNode(true);n.appendChild(r);r.className=i%2==0?this.even:this.odd;var cells=T$$('td',r);for(var z=0;z<t.w;z++){cells[z].className=y==z?i%2==0?this.evensel:this.oddsel:''}}t.replaceChild(n,t.b);if(this.paginate){this.size(this.pagesize)}};sorter.prototype.page=function(s){var t=ge(this.e),i=0,l=s+parseInt(this.pagesize);for(i;i<this.l;i++){t.r[i].style.display=i>=s&&i<l?'':'none'}};sorter.prototype.move=function(d,m){var s=d==1?(m?this.d:this.g+1):(m?1:this.g-1);if(s<=this.d&&s>0){this.g=s;this.page((s-1)*this.pagesize)}};sorter.prototype.size=function(s){this.pagesize=s;this.g=1;this.pages();this.page(0);};sorter.prototype.pages=function(){this.d=Math.ceil(this.l/this.pagesize)};function ge(e){var t=T$(e);t.b=T$$('tbody',t)[0];t.r=t.b.rows;return t};function cp(f,c){var g,h;f=g=f.v.toLowerCase(),c=h=c.v.toLowerCase();var i=parseFloat(f.replace(/(\$|\,)/g,'')),n=parseFloat(c.replace(/(\$|\,)/g,''));if(!isNaN(i)&&!isNaN(n)){g=i,h=n}i=Date.parse(f);n=Date.parse(c);if(!isNaN(i)&&!isNaN(n)){g=i;h=n}return g>h?1:(g<h?-1:0)};return{sorter:sorter}}();
var sorter = new TINY.table.sorter("sorter");
sorter.head = "head";
sorter.asc = "asc";
sorter.desc = "desc";
sorter.init("table",1);
</script>






